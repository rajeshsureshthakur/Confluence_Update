-- Combine all tables and create a unified view
WITH UnifiedMetrics AS (
    -- Table 1 (assuming CPU metrics)
    SELECT 
        application_name,
        metric,
        value,
        'CPU' as metric_category
    FROM table1
    
    UNION ALL
    
    -- Table 2 (assuming Memory metrics)
    SELECT 
        application_name,
        metric,
        value,
        'Memory' as metric_category
    FROM table2
    
    UNION ALL
    
    -- Table 3 (assuming GC metrics)
    SELECT 
        application_name,
        metric,
        value,
        'GC' as metric_category
    FROM table3
    
    UNION ALL
    
    -- Table 4 (assuming other metrics)
    SELECT 
        application_name,
        metric,
        value,
        'Other' as metric_category
    FROM table4
),

-- Create a pivot to transform the data
MetricSummary AS (
    SELECT 
        application_name,
        MAX(CASE WHEN metric_category = 'CPU' THEN value END) as cpu_metric,
        MAX(CASE WHEN metric_category = 'Memory' THEN value END) as memory_metric,
        MAX(CASE WHEN metric_category = 'GC' THEN value END) as gc_metric,
        MAX(CASE WHEN metric_category = 'Other' THEN value END) as other_metric
    FROM UnifiedMetrics
    GROUP BY application_name
)

-- Final formatted output
SELECT 
    application_name as "Application",
    COALESCE(cpu_metric, 'N/A') as "CPU Metrics",
    COALESCE(memory_metric, 'N/A') as "Memory Metrics",
    COALESCE(gc_metric, 'N/A') as "GC Metrics",
    COALESCE(other_metric, 'N/A') as "Other Metrics"
FROM MetricSummary
ORDER BY 
    application_name;
