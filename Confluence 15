SELECT 
    "Application",
    "Value" as "CPU Value",
    CASE
        WHEN CAST("Value" as DECIMAL) >= 90 THEN 'Critical'
        WHEN CAST("Value" as DECIMAL) >= 80 THEN 'Warning'
        ELSE 'Normal'
    END as "Status"
FROM T1 
WHERE "Metric" LIKE '%CPU Usage%' 
  AND "Value" IS NOT NULL 
  AND CAST("Value" as DECIMAL) >= 80

UNION ALL

SELECT 
    "Application",
    "Value" as "CPU Value",
    CASE
        WHEN CAST("Value" as DECIMAL) >= 90 THEN 'Critical'
        WHEN CAST("Value" as DECIMAL) >= 80 THEN 'Warning'
        ELSE 'Normal'
    END as "Status"
FROM T2
WHERE "Metric" LIKE '%CPU Usage%' 
  AND "Value" IS NOT NULL 
  AND CAST("Value" as DECIMAL) >= 80

UNION ALL

SELECT 
    "Application",
    "Value" as "CPU Value",
    CASE
        WHEN CAST("Value" as DECIMAL) >= 90 THEN 'Critical'
        WHEN CAST("Value" as DECIMAL) >= 80 THEN 'Warning'
        ELSE 'Normal'
    END as "Status"
FROM T3
WHERE "Metric" LIKE '%CPU Usage%' 
  AND "Value" IS NOT NULL 
  AND CAST("Value" as DECIMAL) >= 80

UNION ALL

SELECT 
    "Application",
    "Value" as "CPU Value",
    CASE
        WHEN CAST("Value" as DECIMAL) >= 90 THEN 'Critical'
        WHEN CAST("Value" as DECIMAL) >= 80 THEN 'Warning'
        ELSE 'Normal'
    END as "Status"
FROM T4
WHERE "Metric" LIKE '%CPU Usage%' 
  AND "Value" IS NOT NULL 
  AND CAST("Value" as DECIMAL) >= 80

ORDER BY CAST("CPU Value" as DECIMAL) DESC
